#+title: ffmpeg with libmp3lame & H.264 encoder support
#+date: <2017-04-02>
#+keywords: ffmpeg, libmp3lame
#+setupfile: ../org-templates/post.org

How to manually install =ffmpeg= with =libmp3lame= & H.264 encoder support.

** Clone ffmpeg
   #+BEGIN_SRC shell
     git clone https://git.ffmpeg.org/ffmpeg.git
   #+END_SRC

   Note: You need to install =nasm= to compile lame & libx264. On Fedora install using
   #+BEGIN_SRC shell
     dnf install nasm -y
   #+END_SRC

** Lame encoder
   #+BEGIN_SRC shell -n
     BUILD_DIR="$HOME/ffmpeg/ffmpeg_build"
     cd ffmpeg/
     curl -O -L https://downloads.sourceforge.net/project/lame/lame/3.100/lame-3.100.tar.gz
     tar xzvf lame-3.100.tar.gz
     cd lame-3.100
     ./configure --prefix="$BUILD_DIR" --bindir="$HOME/bin" --disable-shared --enable-nasm
     make
     make install
     cd ..
   #+END_SRC

** H.264 Encoder
   #+BEGIN_SRC shell -n
     git clone --depth 1 https://code.videolan.org/videolan/x264
     cd x264
     PKG_CONFIG_PATH="$BUILD_DIR/lib/pkgconfig" ./configure --prefix="$BUILD_DIR" --bindir="$HOME/bin" --enable-static
     make
     make install
     cd ..
   #+END_SRC

** Compile and Install ffmpeg
   #+BEGIN_SRC shell -n
     PATH="$HOME/bin:$PATH" PKG_CONFIG_PATH="$BUILD_DIR/lib/pkgconfig" ./configure \
	 --prefix="$BUILD_DIR" \
	 --pkg-config-flags="--static" \
	 --extra-cflags="-I$BUILD_DIR/include" \
	 --extra-ldflags="-L$BUILD_DIR/lib" \
	 --extra-libs=-lpthread \
	 --extra-libs=-lm \
	 --bindir="$HOME/bin" \
	 --enable-gpl \
	 --enable-libmp3lame \
	 --enable-libx264 \
	 --enable-nonfree

     make
     make install
   #+END_SRC

#+INCLUDE: "../disquss.inc"
